module implode-irhg
imports liblib irhg implode-iregexp logging

strategies

  main-implode-irhg =
    io-wrap(try-implode-iregexp(try-implode-node))

strategies

  try-implode-node =
    rec x(
       implode-node
    <+ log(|Error(), "Cannot implode node", <id>); fail
    )

rules

  implode-node :
    String(s) -> s

  implode-node :
    Int(i) -> i

  implode-node : 
    Appl(Nonterm(nt), Term(t), i, lc) -> t#(<implode-to-list(try-implode-iregexp(try-implode-node))> i){anno*}
      where <map(
              \ LContent(l, inst) -> (l#([]), <implode-iregexp(try-implode-iregexp(try-implode-node), try-implode-node)> inst) \
            )> lc => [anno*]