module switch-options
imports options

strategies

  SwitchOption(switch, description) =
      where(<switch; construct-long-switch> () => sw)
    ; ArgOption(?sw
      , where(<set-config> (sw, <norm-switch-arg>))
      , <concat-strings> [sw, " on|off    ", <description> (), " (default: on)"]
      )
      
  if-switch(switch, strat) =
    if-switch(switch, start, id)
    
  if-switch(switch, then, else) =
    if( where(<switch; construct-long-switch> () => sw)
      ; where(<eval-config-switch> sw)
    , then
    , else
    )
    
  eval-config-switch =
    get-config < ?"on" + id

  norm-switch-arg =
      lower-case
    ; (?"off" + ?"on")

  construct-long-switch =
    <conc-strings> ("--", <id>)