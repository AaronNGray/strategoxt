Specification([Imports(["ATerms","options"]),Strategies([SDef("io-explode-aterm",[],Call(SVar("io-wrap"),[Call(SVar("explode-aterm"),[])]))]),Strategies([SDef("explode-aterm",[],LChoice(Call(SVar("explode-list"),[]),LChoice(Call(SVar("explode-int"),[]),LChoice(Call(SVar("explode-fun"),[]),Call(SVar("explode-appl"),[]))))),SDef("implode-aterm",[],LChoice(Call(SVar("implode-list"),[]),LChoice(Call(SVar("implode-int"),[]),LChoice(Call(SVar("implode-fun"),[]),Call(SVar("implode-appl"),[])))))]),Rules([RDef("explode-list",[],Rule(Anno(Op("Cons",[Var(ListVar("x*")),Op("Nil",[])]),Op("Nil",[])),Op("list",[Op("not-empty",[App(Call(SVar("map"),[Call(SVar("explode-aterm"),[])]),Var(ListVar("x*")))])]),Id)),RDef("implode-list",[],Rule(Op("list",[Op("not-empty",[Var(ListVar("x*"))])]),App(Call(SVar("map"),[Call(SVar("implode-aterm"),[])]),Var(ListVar("x*"))),Id)),RDef("explode-int",[],Rule(Anno(Var("i"),Op("Nil",[])),Op("constant",[Op("int",[Op("natural",[App(Call(SVar("int-to-string"),[]),Var("i"))])])]),BA(Call(SVar("is-int"),[]),Var("i")))),RDef("implode-int",[],Rule(Op("constant",[Op("int",[Op("natural",[Var("s")])])]),App(Call(SVar("string-to-int"),[]),Var("s")),Id)),RDef("explode-fun",[],Rule(Anno(Explode(Var("s"),Op("Nil",[])),Op("Nil",[])),Op("fun",[App(Call(SVar("explode-afun"),[]),Var("s"))]),Id)),RDef("implode-fun",[],Rule(Op("fun",[Var("s1")]),Explode(Var("s2"),Op("Nil",[])),AM(BA(Call(SVar("implode-afun"),[]),Var("s1")),Var("s2")))),RDef("explode-appl",[],Rule(Anno(Explode(Var("s"),Op("Cons",[Var(ListVar("x*")),Op("Nil",[])])),Op("Nil",[])),Op("appl",[App(Call(SVar("explode-afun"),[]),Var("s")),App(Call(SVar("map"),[Call(SVar("explode-aterm"),[])]),Var(ListVar("x*")))]),Id)),RDef("implode-appl",[],Rule(Op("appl",[Var("s1"),Var(ListVar("x*"))]),Explode(Var("s2"),App(Call(SVar("map"),[Call(SVar("implode-aterm"),[])]),Var(ListVar("x*")))),AM(BA(Call(SVar("implode-afun"),[]),Var("s1")),Var("s2")))),RDef("explode-afun",[],Rule(Var("s"),Op("uqlit",[Var("s")]),BA(Not(Call(SVar("is-double-quoted"),[])),Var("s")))),RDef("explode-afun",[],Rule(Var("s"),Op("qlit",[Var("s")]),BA(Call(SVar("is-double-quoted"),[]),Var("s")))),RDef("implode-afun",[],Rule(Op("uqlit",[Var("s")]),Var("s"),Id)),RDef("implode-afun",[],Rule(Op("qlit",[Var("s")]),Var("s"),Id))])])
