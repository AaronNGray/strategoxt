definition
module Main
exports
  context-free start-symbols Exp
  sorts IntConst Exp
  
  lexical syntax
    [\ \t\n]  -> LAYOUT
    [0-9]+    -> IntConst
    [A-Za-z]+ -> Id
      
  context-free syntax
    IntConst  -> Exp {cons("Int")}

    "(" Exp "+" Exp ")" -> Exp {ast("Plus(<1>)")}
    "(" Exp "-" Exp ")" -> Exp {ast("Minus(<2>)")}
    
    Id "(" {Exp ","}* "|" {Exp ","}* ")" -> Exp {ast("Call(<1>, <conc(<2>, <3>)>)")}
    Id "(" {Exp ","}* "&" Exp  ")" -> Exp {ast("Call(<1>, <conc(<2>, [<3>])>)")}
