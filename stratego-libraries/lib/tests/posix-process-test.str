module posix-process-test
imports libstratego-lib

strategies

  main = 
    test-suite(!"posix-process-test",
      kill-tests
    )

  /**
   * @todo SIGKILL cannot be used because of problems with overlays over library boundaries.
   */
  kill-tests =
    apply-test(!"kill own process", fork-wait-test(kill-myself), !(), !Signal("KILL",  9, "Kill"))

  kill-myself = 
    <kill> (<get-pid>, Signal("KILL",  9, "Kill"))

  fork-wait-test(child) =
    fork(child, ?(<waitpid>, t); ?WaitStatus(_, <signal-from-number>, _))

