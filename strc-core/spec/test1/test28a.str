module test28a
imports tuple-cons list-cons
signature
  sorts Exp Type
  constructors
    Var   : String -> Exp
    Plus  : Exp * Exp -> Exp
    Int   : Type
    Float : Type 
    Foo   : List(Type) -> Type
    stderr : Bla

strategies

  debug(s) =
    where(?x; s => y; prim("SSL_printnl", stderr, [y, x]))

  try(s) = 
    s <+ id

  main =
    !Var("a"){Int, Float}
    ; debug(!"a: ")
    ; try( \ Var(s){ts*} -> Var(s){Foo(ts*)} \ )
    ; debug(!"b: ")
    ; ?Var("a"){Foo([Int,Float])}
    ; debug(!"c: ")
    ; {a* : ?a* }
    ; debug(!"d: ")
    ; ?Var("a"){Foo([a, b*])}
    ; debug(!"e: ")
    ; ![b*,a,b*]
    ; debug(!"f: ")

  conc :
    ([x | xs], ys) -> [x | <conc>(xs, ys)]

  conc :
    ([], ys) -> ys

