/**
 * extract: translate a specification to core Stratego and extract needed definitions
 */

module extract
imports needed-defs desugar needed-constructors
strategies

  extract-io = 
    io-wrap(
      Specification([id, id, Strategies(check-dynamic-calls ; needed-defs)])
      ; needed-constructors
    )

  check-dynamic-calls =
    if not( fetch-elem(?SDefT("DYNAMIC-CALLS", [], [], _)) ) then
      ![ SDefT("DYNAMIC-CALLS", [], [], Fail) | <id> ]
    end



