module foo

imports
  libstratego-lib
  
signature constructors
  Foo : Term

rules

  main =
    ![1,2,3]
    ; localmap(localinc)
  
  localmap(s) = 
    rec x([] + [s | x])
  
  localinc =
    <localadd> (<id>, 1)
  
  localadd =
   ?(x,y); prim("SSL_addi",x,y)

   /*
   main =
     let foo =
       !x; { x: foo }
     in
       map(foo)
     end
   
   
   */

  /*
  main =
    ![1,2,3];
    y := 3
    ; localmap(?x)
    ; !x
  
  /*
  localmap(s) = 
    rec rec(s <+ rec)
  */