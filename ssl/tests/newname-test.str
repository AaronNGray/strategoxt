module newname-test
imports newname sunit

strategies 

  main = 
    test-suite(!"newname-test",
      newname-basic-tests
    ; newname-shared-tests
    ; newname-grouped-tests
    )

strategies

  newname-basic-tests =
    do-test(!"basic-1", newname(|"var_") => "var_0")
  ; do-test(!"basic-2", newname(|"var_") => "var_1")
  ; do-test(!"basic-3", newname(|"fun_") => "fun_0")
  ; do-test(!"basic-4", newname(|"var_") => "var_2")
  ; do-test(!"basic-5", newname(|"fun_") => "fun_1")

  newname-shared-tests =
    do-test(!"shared-1", newname-shared(|"var_") => "var_0")
  ; do-test(!"shared-2", newname-shared(|"var_") => "var_1")
  ; do-test(!"shared-3", newname-shared(|"fun_") => "fun_2")
  ; do-test(!"shared-4", newname-shared(|"var_") => "var_3")
  ; do-test(!"shared-5", newname-shared(|"fun_") => "fun_4")

  newname-grouped-tests =
    do-test(!"grouped-1", newname(|"var_", "mymod1") => "var_0")
  ; do-test(!"grouped-2", newname(|"var_", "mymod2") => "var_0")
  ; do-test(!"grouped-3", newname(|"fun_", "mymod1") => "fun_1")
  ; do-test(!"grouped-4", newname(|"var_", "mymod1") => "var_2")
  ; do-test(!"grouped-5", newname(|"fun_", "mymod2") => "fun_1")
