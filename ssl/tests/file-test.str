module file-test
imports file sunit

strategies 

  main = 
    test-suite(!"file-test",
      dirname-tests
    ; file-props-tests
    ; basename-tests
    ; base-filename-tests
    ; get-path-tests
    ; get-filename-tests
    ; getcwd-tests
    ; abspath-tests
    ; is-abspath-tests
    )
    
strategies
    
  dirname-tests =
      apply-test(!"dirname -- 1", dirname, !"/", !"/")
    ; apply-test(!"dirname -- 2", dirname, !"bla", !".")
    ; apply-test(!"dirname -- 3", dirname, !"bla/", !".")
    ; apply-test(!"dirname -- 4", dirname, !"/bla", !"/")
    ; apply-test(!"dirname -- 5", dirname, !"/bla/", !"/")
    ; apply-test(!"dirname -- 6", dirname, !"foo/bla", !"foo")
    ; apply-test(!"dirname -- 7", dirname, !"foo/bla/", !"foo")
    ; apply-test(!"dirname -- 8", dirname, !"/foo/bla", !"/foo")
    ; apply-test(!"dirname -- 9", dirname, !"/foo/bla/", !"/foo")

  is-abspath-tests =
      apply-test(!"is-abspath -- 1", is-abspath, !"/", !"/")
    ; apply-test(!"is-abspath -- 2", is-abspath, !"/bla", !"/bla")
    ; apply-and-fail(!"is-abspath -- 3", is-abspath, !"bla")
    ; apply-and-fail(!"is-abspath -- 4", is-abspath, !"./bla")

  getcwd-tests =
      apply-test(!"getcwd -- 1", getcwd, !())

  abspath-tests =
      where(getcwd => cwd)
    ; apply-test(!"abspath -- 1", abspath, !"/", !"/")
    ; apply-test(!"abspath -- 2", abspath, !"/bla", !"/bla")
    ; apply-test(!"abspath -- 3", abspath, !"bla", <conc-strings> (cwd, "/bla"))
    ; apply-test(!"abspath -- 4", abspath, !"./bla", <conc-strings> (cwd, "/./bla"))

  file-props-tests =
      apply-and-fail(!"create? -- 1", can-create-file, !"/root/bla.txt")
    ; apply-test(!"create? -- 2", can-create-file, !"/tmp/bla.txt", !"/tmp/bla.txt")

  basename-tests = 
    apply-test(!"basename-test 1", basename, !"./number.r", !"./number")
  ; apply-test(!"basename-test 2", basename, !"./number",   !"./number")
  ; apply-test(!"basename-test 3", basename, !"/usr/bin/number.str", !"/usr/bin/number")

  base-filename-tests = 
    apply-test(!"base-filename-test 1", base-filename, !"./number.r", !"number.r")
  ; apply-test(!"base-filename-test 2", base-filename, !"./number",   !"number")
  ; apply-test(!"base-filename-test 3", base-filename, !"/usr/bin/number.str", !"number.str")

  get-path-tests =
    apply-test(!"get-path-test1"
    , get-path
    , !"/usr/local/bin/prog"
    , !"/usr/local/bin/"
    )
  ; apply-test(!"get-path-test2"
    , get-path
    , !"prog"
    , !""
    )

  get-filename-tests =
    apply-test(!"get-filename-test1"
    , get-filename
    , !"/usr/local/bin/prog"
    , !"prog"
    )
  ; apply-test(!"get-filename-test2"
    , get-filename
    , !"prog"
    , !"prog"
    )

/**
 * Copyright (C) 1998-2003 Eelco Visser <visser@acm.org>
 * 
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2, or (at your option)
 * any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
 * 02111-1307, USA.
 */