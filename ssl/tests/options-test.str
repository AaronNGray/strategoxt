module options-test
imports parse-options options sunit
signature
  constructors
    Test:                Option
    TestValue: String -> Option
    NoTestValue: String -> Option

    A : Term
    B : Term
    C : Term
    D : Term

strategies

  main =
    test-suite(!"options-test",
      has-option-test
    ; option-value-test1
    ; option-value-test2
    )

  has-option-test = 
    apply-test(!"has-option-test"
    , fake-options; has-option(!Test)
    , !()
    , id
    )

  option-value-test1 = 
    apply-test(!"option-value-test1"
    , fake-options; option-value(\ TestValue(v) -> v \,fail)
    , !()
    , !"foo"
    )

  option-value-test2 = 
    apply-test(!"option-value-test1"
    , fake-options; option-value(\ NoTestValue(v) -> v \,!"bar")
    , !()
    , !"bar"
    )

  fake-options = 
     !["options-test",2,Test(),TestValue("foo")]
   ; store-options
