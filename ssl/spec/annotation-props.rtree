Specification([Imports(["lib"]),Strategies([SDef("valid-props-term",[],Call(SVar("Anno_Cong__"),[Id,[Call(SVar("valid-props"),[])]])),SDef("valid-props",[],Call(SVar("risky"),[Build(Str("Not a valid properties annotation: ")),Seq(Call(SVar("is-list"),[]),Call(SVar("map"),[Match(Op("",[Wld,Wld]))]))])),SDef("get-props",[],Call(SVar("if-annotation"),[Call(SVar("get-annotations"),[]),Build(Op("Nil",[]))])),SDef("preserve-props",[DefaultVarDec("s")],Call(SVar("preserve-annotation"),[Call(SVar("s"),[])])),SDef("merge-props",[DefaultVarDec("s")],Call(SVar("if-annotation"),[Call(SVar("Merge-Props"),[Call(SVar("s"),[])]),Call(SVar("s"),[])])),SDef("has-prop",[DefaultVarDec("p")],Where(Call(SVar("get-prop"),[Call(SVar("p"),[])]))),SDef("has-prop",[DefaultVarDec("p"),DefaultVarDec("c")],Where(Seq(Call(SVar("get-prop"),[Call(SVar("p"),[])]),Call(SVar("c"),[])))),SDef("get-prop",[DefaultVarDec("p")],Seq(Call(SVar("get-annotations"),[]),BA(Call(SVar("lookup"),[]),Op("",[App(Call(SVar("p"),[]),Op("",[])),RootApp(Id)])))),SDef("apply-prop",[DefaultVarDec("p"),DefaultVarDec("s")],Call(SVar("if-annotation"),[Call(SVar("apply-prop-existing"),[Call(SVar("p"),[]),Call(SVar("s"),[])]),Id])),SDef("replace-prop",[DefaultVarDec("p"),DefaultVarDec("v")],Call(SVar("apply-prop"),[Call(SVar("p"),[]),Call(SVar("v"),[])])),SDef("add-prop",[DefaultVarDec("p"),DefaultVarDec("v")],Call(SVar("if-annotation"),[Call(SVar("add-prop-existing"),[Call(SVar("p"),[]),Call(SVar("v"),[])]),Call(SVar("add-prop-empty"),[Call(SVar("p"),[]),Call(SVar("v"),[])])])),SDef("set-prop",[DefaultVarDec("p"),DefaultVarDec("v")],GuardedLChoice(Call(SVar("has-prop"),[Call(SVar("p"),[])]),Call(SVar("replace-prop"),[Call(SVar("p"),[]),Call(SVar("v"),[])]),Call(SVar("add-prop"),[Call(SVar("p"),[]),Call(SVar("v"),[])])))]),Strategies([SDef("is-same-prop",[],Match(Op("",[Op("",[Var("p"),Wld]),Op("",[Var("p"),Wld])]))),SDef("is-prop",[DefaultVarDec("p")],Where(Seq(Build(Op("",[RootApp(Seq(Id,Call(SVar("Fst"),[]))),App(Call(SVar("p"),[]),Op("",[]))])),Call(SVar("eq"),[])))),SDef("apply-prop-existing",[DefaultVarDec("p"),DefaultVarDec("s")],Call(SVar("Anno_Cong__"),[Id,[Call(SVar("map"),[Call(SVar("apply-2-prop"),[Call(SVar("is-prop"),[Call(SVar("p"),[])]),Call(SVar("s"),[])])])]])),SDef("apply-2-prop",[DefaultVarDec("c"),DefaultVarDec("s")],GuardedLChoice(Where(Call(SVar("c"),[])),Call(SVar(""),[Id,Call(SVar("s"),[])]),Id)),SDef("apply-2-prop",[DefaultVarDec("s")],Call(SVar(""),[Id,Call(SVar("s"),[])])),SDef("add-prop-existing",[DefaultVarDec("p"),DefaultVarDec("v")],Call(SVar("Anno_Cong__"),[Id,[Build(Op("Cons",[Op("",[App(Call(SVar("p"),[]),Op("",[])),App(Call(SVar("v"),[]),Op("",[]))]),RootApp(Id)]))]])),SDef("add-prop-empty",[DefaultVarDec("p"),DefaultVarDec("v")],Seq(Match(Var("t")),Build(Anno(Var("t"),Op("Cons",[Op("",[App(Call(SVar("p"),[]),Op("",[])),App(Call(SVar("v"),[]),Op("",[]))]),Op("Nil",[])]))))),SDef("props-union",[],Seq(Match(Op("",[Var("ps1"),Var("ps2")])),BA(Call(SVar("union"),[]),Op("",[Var("ps1"),App(Call(SVar("diff"),[Call(SVar("is-same-prop"),[])]),Op("",[Var("ps2"),Var("ps1")]))]))))]),Rules([RDef("Merge-Props",[DefaultVarDec("s")],Rule(Anno(Var("t"),Op("Cons",[Var(ListVar("p1*")),Op("Nil",[])])),Anno(Var("r"),Op("Cons",[Var(ListVar("p2*")),Op("Nil",[])])),Seq(AM(BA(Call(SVar("s"),[]),Var("t")),Var("r")),AM(BA(Call(SVar("props-union"),[]),Op("",[App(Call(SVar("get-props"),[]),Var("r")),Op("Cons",[Var(ListVar("p1*")),Op("Nil",[])])])),Op("Cons",[Var(ListVar("p2*")),Op("Nil",[])])))))])])