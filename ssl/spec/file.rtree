Specification([Imports(["io"]),Rules([RDef("find-in-path",[],Rule(Op("",[Var("file"),Var("path")]),App(Rec("x",LChoice(LRule(Rule(Op("Cons",[Var("dir"),Wld]),App(Seq(Call(SVar("concat-strings"),[]),Call(SVar("file-exists"),[])),Op("Cons",[Var("dir"),Op("Cons",[Str("/"),Op("Cons",[Var("file"),Op("Nil",[])])])])),Id)),Seq(Call(SVar("Tl"),[]),Call(SVar("x"),[])))),Var("path")),Id))]),Strategies([SDef("find-in-path",[DefaultVarDec("mkpath")],LChoice(Call(SVar("file-exists"),[]),LChoice(Seq(Call(SVar("split"),[Id,Call(SVar("mkpath"),[])]),Call(SVar("find-in-path"),[])),LRule(Rule(Var("x"),App(Call(SVar("fatal-error"),[]),Op("Cons",[Str("no such file: "),Op("Cons",[Var("x"),Op("Nil",[])])])),Id))))),SDef("find-file",[DefaultVarDec("mkpath"),DefaultVarDec("ext")],Seq(Call(SVar("guarantee-extension"),[Call(SVar("ext"),[])]),Call(SVar("find-in-path"),[Call(SVar("mkpath"),[])])))])])