Specification([Imports(["posix-file","io","list-basic","list-misc","string"]),Strategies([SDef("open-stream",[],Seq(Match(Op("",[Wld,Wld])),LChoice(Seq(Call(SVar("Fst"),[]),Call(SVar("stdio-stream"),[])),LChoice(Seq(Call(SVar(""),[Match(Op("Path",[RootApp(Id)])),Id]),Call(SVar("fopen"),[])),Seq(Call(SVar(""),[Call(SVar("is-string"),[]),Id]),Call(SVar("fopen"),[])))))),SDef("stdio-stream",[],Seq(Match(Op("stdin",[])),Call(SVar("stdin-stream"),[]))),SDef("stdio-stream",[],Seq(Match(Op("stdout",[])),Call(SVar("stdout-stream"),[]))),SDef("stdio-stream",[],Seq(Match(Op("stderr",[])),Call(SVar("stderr-stream"),[])))]),Strategies([SDef("file-exists",[],BA(Call(SVar("access"),[]),Op("",[RootApp(Id),Op("Cons",[Op("F_OK",[]),Op("Nil",[])])]))),SDef("can-read-file",[],BA(Call(SVar("access"),[]),Op("",[RootApp(Id),Op("Cons",[Op("R_OK",[]),Op("Nil",[])])]))),SDef("is-readable",[],Call(SVar("can-read-file"),[])),SDef("can-write-file",[],BA(Call(SVar("access"),[]),Op("",[RootApp(Id),Op("Cons",[Op("W_OK",[]),Op("Nil",[])])]))),SDef("is-writable",[],Call(SVar("can-write-file"),[])),SDef("can-execute-file",[],BA(Call(SVar("access"),[]),Op("",[RootApp(Id),Op("Cons",[Op("X_OK",[]),Op("Nil",[])])]))),SDef("is-executable",[],Call(SVar("can-exutable-file"),[])),SDef("can-create-file",[],Where(Seq(Call(SVar("dirname"),[]),Call(SVar("can-write-file"),[]))))]),Strategies([SDef("dirname",[],Call(SVar("string-as-chars"),[Seq(Call(SVar("try"),[Seq(Call(SVar("split-init-last"),[]),Match(Op("",[RootApp(Id),Int(47)])))]),GuardedLChoice(Match(Op("Nil",[])),Build(Op("Cons",[Int(47),Op("Nil",[])])),Seq(Call(SVar("init"),[]),Seq(Call(SVar("repeat"),[Seq(Call(SVar("split-init-last"),[]),Seq(Call(SVar(""),[Id,Not(Match(Int(47)))]),Call(SVar("Fst"),[])))]),GuardedLChoice(Match(Op("Nil",[])),Build(Op("Cons",[Int(46),Op("Nil",[])])),Seq(Call(SVar("repeat"),[Seq(Call(SVar("split-init-last"),[]),Match(Op("",[RootApp(Id),Int(47)])))]),GuardedLChoice(Match(Op("Nil",[])),Build(Op("Cons",[Int(47),Op("Nil",[])])),Id)))))))]))]),Strategies([SDef("read-text-file",[],Seq(Match(Var("file")),Seq(AM(BA(Call(SVar("fopen"),[]),Op("",[Var("file"),Str("r")])),Var("stream")),Seq(Rec("x",LChoice(Build(Op("Cons",[App(Call(SVar("fgetc"),[]),Var("stream")),App(Call(SVar("x"),[]),Op("",[]))])),Build(Op("Nil",[])))),Seq(Where(BA(Call(SVar("fclose"),[]),Var("stream"))),Call(SVar("implode-string"),[])))))),SDef("write-text-file",[],Seq(Match(Op("",[Var("file"),Var("string")])),Seq(BA(Call(SVar("fopen"),[]),Op("",[Var("file"),Str("w")])),Seq(BA(Call(SVar("fputs"),[]),Op("",[Var("string"),RootApp(Id)])),Call(SVar("fclose"),[])))))]),Strategies([SDef("find-in-path",[],Seq(Match(Op("",[Var("file"),RootApp(Id)])),Call(SVar("fetch-elem"),[BA(Seq(Call(SVar("concat-strings"),[]),Call(SVar("file-exists"),[])),Op("Cons",[RootApp(Id),Op("Cons",[Str("/"),Op("Cons",[Var("file"),Op("Nil",[])])])]))]))),SDef("find-in-path",[DefaultVarDec("mkpath")],LChoice(Call(SVar("file-exists"),[]),LChoice(Seq(Call(SVar("split"),[Id,Call(SVar("mkpath"),[])]),Call(SVar("find-in-path"),[])),BA(Call(SVar("fatal-error"),[]),Op("Cons",[Str("no such file: "),Op("Cons",[RootApp(Id),Op("Nil",[])])]))))),SDef("find-file",[DefaultVarDec("mkpath"),DefaultVarDec("ext")],Seq(Call(SVar("guarantee-extension"),[Call(SVar("ext"),[])]),Call(SVar("find-in-path"),[Call(SVar("mkpath"),[])]))),SDef("find-file",[DefaultVarDec("ext")],Seq(Call(SVar(""),[Call(SVar("guarantee-extension"),[Call(SVar("ext"),[])]),Id]),Call(SVar("find-in-path"),[])))])])
