Specification([Imports(["tables","io"]),Signature([Constructors([OpDecl("Scopes",ConstType(Var("Key")))])]),Strategies([SDef("init-name-space",[DefaultVarDec("ns")],Where(Seq(Call(SVar("ns"),[]),Call(SVar("table-create"),[])))),SDef("exit-name-space",[DefaultVarDec("ns")],Where(Seq(Call(SVar("ns"),[]),Call(SVar("table-destroy"),[])))),SDef("begin-scope",[DefaultVarDec("ns")],Where(Seq(AM(Call(SVar("ns"),[]),Var("ns")),BA(Call(SVar("table-put"),[]),Op("",[Var("ns"),Var("Scopes"),Op("Cons",[Op("Nil",[]),App(LChoice(Call(SVar("table-get"),[]),Build(Op("Nil",[]))),Op("",[Var("ns"),Var("Scopes")]))])]))))),SDef("end-scope",[DefaultVarDec("ns")],Where(Seq(AM(Call(SVar("ns"),[]),Var("ns")),Seq(AM(LChoice(BA(Call(SVar("table-get"),[]),Op("",[Var("ns"),Var("Scopes")])),Build(Op("Cons",[Op("Nil",[]),Op("Nil",[])]))),Op("Cons",[Var("scope"),Var("scopes")])),Seq(BA(Call(SVar("table-put"),[]),Op("",[Var("ns"),Var("Scopes"),Var("scopes")])),BA(Call(SVar("map"),[LRule(Rule(Var("key"),App(Call(SVar("table-pop"),[]),Op("",[Var("ns"),Var("key")])),Id))]),Var("scope"))))))),SDef("scope",[DefaultVarDec("ns"),DefaultVarDec("s")],Seq(Call(SVar("begin-scope"),[Call(SVar("ns"),[])]),Call(SVar("restore-always"),[Call(SVar("s"),[]),Call(SVar("end-scope"),[Call(SVar("ns"),[])])]))),SDef("assert",[DefaultVarDec("ns")],Seq(Match(Op("",[Var("key"),Var("val")])),Where(Seq(AM(Call(SVar("ns"),[]),Var("ns")),Seq(BA(Call(SVar("table-push"),[]),Op("",[Var("ns"),Var("key"),Var("val")])),Seq(AM(LChoice(BA(Call(SVar("table-get"),[]),Op("",[Var("ns"),Var("Scopes")])),Build(Op("Cons",[Op("Nil",[]),Op("Nil",[])]))),Op("Cons",[Var("scope"),Var("scopes")])),BA(Call(SVar("table-put"),[]),Op("",[Var("ns"),Var("Scopes"),Op("Cons",[Op("Cons",[Var("key"),Var("scope")]),Var("scopes")])])))))))),SDef("override-key",[DefaultVarDec("ns")],Seq(Match(Op("",[Var("key"),Var("val")])),Where(Seq(AM(Call(SVar("ns"),[]),Var("ns")),BA(Call(SVar("table-replace"),[]),Op("",[Var("ns"),Var("key"),Var("val")])))))),SDef("rewrite",[DefaultVarDec("ns")],LRule(Rule(Var("key"),App(Call(SVar("table-lookup"),[]),Op("",[App(Call(SVar("ns"),[]),Op("",[])),Var("key")])),Id)))])])