Specification([Imports(["simple-traversal","tuple","list","rename"]),Strategies([SDef("subs-args",[],LChoice(Match(Op("",[Var("sbs"),Var("t")])),LRule(Rule(Op("",[Var("xs"),Var("ys"),Var("t")]),Op("",[App(Call(SVar("zip"),[Id]),Op("",[Var("xs"),Var("ys")])),Var("t")]),Id))))]),Rules([RDef("SubsVar",[DefaultVarDec("isvar"),DefaultVarDec("mksbs")],Rule(Var("t"),App(Call(SVar("lookup"),[]),Op("",[Var("x"),Var("sbs")])),Seq(AM(BA(Call(SVar("isvar"),[]),Var("t")),Var("x")),AM(Call(SVar("mksbs"),[]),Var("sbs")))))]),Strategies([SDef("substitute",[DefaultVarDec("isvar"),DefaultVarDec("ren")],Seq(AM(Call(SVar("subs-args"),[]),Op("",[Var("sbs"),Var("t")])),Seq(Build(Var("t")),Call(SVar("alltd"),[Seq(Call(SVar("SubsVar"),[Call(SVar("isvar"),[]),Build(Var("sbs"))]),Call(SVar("ren"),[]))])))),SDef("substitute",[DefaultVarDec("isvar")],Call(SVar("substitute"),[Call(SVar("isvar"),[]),Id])),SDef("substitute",[DefaultVarDec("isvar"),VarDec("varshape",FunType([FunType([ConstType(Var("name"))],ConstType(Var("env"))),ConstType(Var("name"))],ConstType(Var("term")))),DefaultVarDec("bndvars"),VarDec("boundin",FunType([FunType([ConstType(Var("term"))],ConstType(Var("term"))),FunType([ConstType(Var("term"))],ConstType(Var("term"))),FunType([ConstType(Var("term"))],ConstType(Var("term"))),ConstType(Var("term"))],ConstType(Var("term")))),VarDec("paste",FunType([FunType([ConstType(Var("term"))],ConstType(Var("vars"))),ConstType(Var("term"))],ConstType(Var("term")))),DefaultVarDec("ren")],Seq(AM(Call(SVar("subs-args"),[]),Op("",[Var("sbs"),Var("t")])),Seq(Build(Op("",[Var("t"),Op("Nil",[])])),Rec("x",Call(SVar("env-alltd"),[LChoice(Call(SVar("RnVar"),[Call(SVar("varshape"),[])]),LChoice(Seq(Call(SVar("Fst"),[]),Seq(Call(SVar("SubsVar"),[Call(SVar("isvar"),[]),Build(Var("sbs"))]),Call(SVar("ren"),[]))),Seq(Call(SVar("RnBinding"),[Call(SVar("bndvars"),[]),Call(SVar("paste"),[])]),Call(SVar("DistBinding"),[Call(SVar("x"),[]),Call(SVar("boundin"),[])]))))]))))),SDef("substitute",[DefaultVarDec("isvar"),VarDec("varshape",FunType([FunType([ConstType(Var("name"))],ConstType(Var("env"))),ConstType(Var("name"))],ConstType(Var("term")))),DefaultVarDec("bndvars"),VarDec("boundin",FunType([FunType([ConstType(Var("term"))],ConstType(Var("term"))),FunType([ConstType(Var("term"))],ConstType(Var("term"))),FunType([ConstType(Var("term"))],ConstType(Var("term"))),ConstType(Var("term"))],ConstType(Var("term")))),VarDec("paste",FunType([FunType([ConstType(Var("term"))],ConstType(Var("vars"))),ConstType(Var("term"))],ConstType(Var("term"))))],Call(SVar("substitute"),[Call(SVar("isvar"),[]),Call(SVar("varshape"),[]),Call(SVar("bndvars"),[]),Call(SVar("boundin"),[]),Call(SVar("paste"),[]),Id]))])])
