Specification([Imports(["abox-ext","annotations"]),Strategies([SDef("ugly-print",[],GuardedLChoice(Call(SVar("has-annotation"),[]),Call(SVar("ugly-print-with-anno"),[]),Call(SVar("ugly-print-without-anno"),[]))),SDef("ugly-print-without-anno",[],LChoice(Call(SVar("UP-Int"),[]),LChoice(Call(SVar("UP-Str"),[]),LChoice(Call(SVar("UP-Cnst"),[]),LChoice(Call(SVar("UP-Lst"),[Call(SVar("ugly-print"),[])]),Call(SVar("UP-App"),[Call(SVar("ugly-print"),[])])))))),SDef("ugly-print-with-anno",[],Build(Op("V0",[Op("Cons",[RootApp(Call(SVar("ugly-print-without-anno"),[])),Op("Cons",[Op("H1",[Op("Cons",[Op("S",[Str("   {")]),Op("Cons",[RootApp(Seq(Call(SVar("get-annotations"),[]),Call(SVar("ugly-print"),[]))),Op("Cons",[Op("S",[Str("}")]),Op("Nil",[])])])])]),Op("Nil",[])])])])))]),Rules([RDef("UP-Cnst",[],Rule(Explode(Var("f"),Op("Nil",[])),Op("S",[Var("f")]),Id)),RDef("UP-App",[DefaultVarDec("s")],Rule(Explode(Var("f"),Var("xs")),Op("H0",[Op("Cons",[Op("S",[Var("f")]),Op("Cons",[Op("Parens",[Op("V0",[App(Seq(Call(SVar("map"),[Call(SVar("s"),[])]),Call(SVar("post-commas"),[])),Var("xs"))])]),Op("Nil",[])])])]),Id)),RDef("UP-Str",[],Rule(Var("x"),App(Call(SVar("Quote"),[]),Op("S",[Var("x")])),BA(Call(SVar("is-string"),[]),Var("x")))),RDef("UP-Int",[],Rule(Var("x"),Op("S",[App(Call(SVar("int-to-string"),[]),Var("x"))]),BA(Call(SVar("is-int"),[]),Var("x")))),RDef("UP-Lst",[DefaultVarDec("s")],Rule(Op("Nil",[]),Op("S",[Str("[]")]),Id)),RDef("UP-Lst",[DefaultVarDec("s")],Rule(As(Var("l"),Op("Cons",[Var("x"),Var("xs")])),Op("H0",[Op("Cons",[Op("S",[Str("[")]),Op("Cons",[Op("V0",[App(Seq(Call(SVar("map"),[Call(SVar("s"),[])]),Call(SVar("post-commas"),[])),Var("l"))]),Op("Cons",[Op("S",[Str("]")]),Op("Nil",[])])])])]),Id))])])