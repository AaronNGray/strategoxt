# GB -- Grammar Base
# Copyright (C) 2001 Merijn de Jonge <mdejonge@cwi.nl>,
#                    Eelco Visser <visser@acm.org>,
#                    Joost Visser <jvisser@cwi.nl>
# 
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
# 
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# 
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
# 02111-1307, USA.
 
# $Id: make_rules.gbtools.in,v 1.2 2002/08/09 16:36:18 mdejonge Exp $


configure.in : grammar.spec
	@(\
	echo "dnl Generated file; do not edit by hand." ;\
	echo "AC_INIT(configure.in)" ;\
	grammar=`echo $(grammar).$(grammar_version)| tr [.] [_]`;\
	echo "AM_INIT_AUTOMAKE($${grammar},0)" ;\
	echo "ACLOCAL=\"\$${ACLOCAL} -I .\"" ;\
	echo "AC_ARG_WITH(gbtools,";\
	echo "   [  --with-gbtools          location of gbtools package ],";\
	echo "   [GBTOOLS=\$${withval}],";\
	echo "   [AC_PATH_PROGS(GBTOOLS,gbadd,no)])";\
	echo "AC_ARG_ENABLE(devel,";\
	echo "   [  --enable-devel          Turn on development environment ],";\
	echo "   [case "\$${enableval}" in";\
	echo "     yes) devel=true ;;";\
	echo "     no)  devel=false ;;";\
	echo "    esac], [devel=false])";\
	echo "AM_CONDITIONAL(DEVEL, test x\$${devel} = xtrue)";\
	echo "if test x\$${devel} = xtrue -a x\$${GBTOOLS} = xno; then";\
	echo "   AC_MSG_ERROR( Required gbtools package not found. )";\
	echo "fi";\
	echo "AC_SUBST(GBTOOLS)";\
	reuses='$(reuses)'; for d in $${reuses} ;\
	do \
           r=`echo $$d | sed 's/\([^-]*\)-.*/\1/' | tr [.] [_]`;\
           echo "AC_ARG_WITH( $${r}, [  --with-$${r}   location of grammar $${r}.] )" ;\
	done ;\
	echo "AC_OUTPUT(";\
	echo Makefile ;\
	echo syntax/Makefile;\
	echo data/Makefile ;\
	echo ")" ;\
	) > $@

include grammar.spec
