Specification([Imports(["exec","tables","config"]),Signature([Sorts([Sort("XtcKey",[])]),Constructors([OpDecl("Tool",FunType([ConstType(Var("String"))],ConstType(Var("XtcKey")))),OpDecl("Repository",ConstType(Var("XtcKey"))),OpDecl("Import",ConstType(Var("XtcKey"))),OpDecl("Imported",FunType([ConstType(Var("String"))],ConstType(Var("XtcKey")))),OpDecl("XTC",ConstType(Var("Table")))])]),Strategies([SDef("xtc-get-repository",[],LChoice(BA(Call(SVar("get-config"),[]),Str("--xtc")),LChoice(BA(Call(SVar("get-config"),[]),Str("--r")),LChoice(BA(Call(SVar("getenv"),[]),Str("XTC_REPOSITORY")),Prim("XTC_REPOSITORY",[]))))),SDef("xtc-read-repository",[],Seq(Match(Var("rep")),Seq(Not(BA(Call(SVar("table-get"),[]),Op("",[Var("XTC"),Op("Imported",[Var("rep")])]))),Seq(Where(BA(Call(SVar("table-put"),[]),Op("",[Var("XTC"),Var("Repository"),Var("rep")]))),Seq(Call(SVar("file-exists"),[]),Seq(Call(SVar("if-verbose4"),[Call(SVar("debug"),[Build(Str("Reading repository: "))])]),Seq(Call(SVar("ReadFromFile"),[]),Seq(BA(Call(SVar("table-putlist"),[]),Op("",[Var("XTC"),RootApp(Id)])),Seq(BA(Call(SVar("table-put"),[]),Op("",[Var("XTC"),Op("Imported",[Var("rep")]),Op("",[])])),Call(SVar("try"),[Seq(BA(Call(SVar("table-get"),[]),Op("",[Var("XTC"),Var("Import")])),Call(SVar("map"),[Call(SVar("try"),[Call(SVar("xtc-read-repository"),[])])]))])))))))))),SDef("xtc-load",[],Seq(Where(LChoice(BA(Call(SVar("table-get"),[]),Op("",[Var("XTC"),Var("Repository")])),Seq(Call(SVar("xtc-get-repository"),[]),Call(SVar("xtc-read-repository"),[])))),Call(SVar("if-verbose5"),[Call(SVar("debug"),[Build(Str("xtc-loaded: "))])]))),SDef("xtc-find",[],Seq(Call(SVar("if-verbose5"),[Call(SVar("debug"),[Build(Str("xtc-find: "))])]),Seq(Call(SVar("xtc-load"),[]),Seq(LChoice(Call(SVar("xtc-find-version-loc"),[]),Call(SVar("xtc-find-loc"),[])),Call(SVar("if-verbose5"),[Call(SVar("debug"),[Build(Str("xtc-find: "))])]))))),RDef("xtc-find-version-loc",[],Rule(Op("",[Var("tool"),Var("version")]),Var("loc"),Seq(BA(Call(SVar("table-get"),[]),Op("",[Var("XTC"),Op("Tool",[Var("tool")])])),Call(SVar("fetch"),[Match(Op("",[Var("version"),Var("loc")]))])))),RDef("xtc-find-loc",[],Rule(Var("tool"),Var("loc"),AM(BA(Call(SVar("table-get"),[]),Op("",[Var("XTC"),Op("Tool",[Var("tool")])])),Op("Cons",[Op("",[Var("version"),Var("loc")]),Wld])))),SDef("xtc-find-warning",[],LChoice(Call(SVar("xtc-find"),[]),Seq(BA(Call(SVar("error"),[]),Op("Cons",[Str("No XTC registration for "),Op("Cons",[RootApp(Id),Op("Cons",[Str(" found"),Op("Nil",[])])])])),Seq(Call(SVar("if-verbose5"),[BA(Seq(Call(SVar("table-getlist"),[]),Call(SVar("debug"),[Build(Str("XTC repository: "))])),Var("XTC"))]),Fail))))])])
