Specification([Imports(["config","xtc-rep","string"]),Strategies([SDef("xtc-find-warning",[],Call(SVar("xtc-find"),[])),SDef("xtc-find",[],LChoice(Seq(Call(SVar("if-verbose5"),[Call(SVar("debug"),[Build(Str("xtc-find: "))])]),Seq(Call(SVar("xtc-load"),[]),Seq(LChoice(Call(SVar("xtc-find-version-loc"),[]),Call(SVar("xtc-find-loc"),[])),Call(SVar("if-verbose5"),[Call(SVar("debug"),[Build(Str("xtc-find: "))])])))),Seq(BA(Call(SVar("error"),[]),Op("Cons",[Str("No XTC registration for "),Op("Cons",[RootApp(Id),Op("Cons",[Str(" found"),Op("Nil",[])])])])),Seq(Call(SVar("if-verbose5"),[BA(Seq(Call(SVar("table-getlist"),[]),Call(SVar("debug"),[Build(Str("XTC repository: "))])),Var("XTC"))]),Fail)))),RDef("xtc-find-version-loc",[],Rule(Op("",[Var("tool"),Var("version")]),Var("loc"),Seq(BA(Call(SVar("table-get"),[]),Op("",[Var("XTC"),Op("Tool",[Var("tool")])])),Call(SVar("fetch"),[Match(Op("",[Var("version"),Var("loc")]))])))),RDef("xtc-find-loc",[],Rule(Var("tool"),Var("loc"),AM(BA(Call(SVar("table-get"),[]),Op("",[Var("XTC"),Op("Tool",[Var("tool")])])),Op("Cons",[Op("",[Var("version"),Var("loc")]),Wld])))),SDef("xtc-find-path",[],Seq(Call(SVar("xtc-find"),[]),Call(SVar("get-path"),[]))),SDef("xtc-register",[],Seq(AM(BA(Call(SVar("get-config"),[]),Str("-t")),Var("tools")),Seq(Call(SVar("if-verbose1"),[Call(SVar("say"),[Build(Str("  Registering tool "))])]),Seq(Call(SVar("if-verbose2"),[Call(SVar("debug"),[Build(Str("    Tools:    "))])]),Seq(AM(BA(Call(SVar("get-config"),[]),Str("-V")),Var("version")),Seq(Call(SVar("if-verbose2"),[Call(SVar("debug"),[Build(Str("    Version:  "))])]),Seq(AM(BA(Call(SVar("get-config"),[]),Str("-l")),Var("loc")),Seq(Call(SVar("if-verbose2"),[Call(SVar("debug"),[Build(Str("    Location: "))])]),Seq(Build(Var("tools")),Call(SVar("map"),[BA(Call(SVar("table-union"),[]),Op("",[Var("XTC"),Op("Tool",[RootApp(Id)]),Op("Cons",[Op("",[Var("version"),App(Call(SVar("concat-strings"),[]),Op("Cons",[Var("loc"),Op("Cons",[Str("/"),Op("Cons",[RootApp(Id),Op("Nil",[])])])]))]),Op("Nil",[])])]))])))))))))),SDef("register-import",[],Seq(AM(BA(Call(SVar("get-config"),[]),Str("import")),Var("imports")),Seq(Call(SVar("if-verbose2"),[Call(SVar("debug"),[Build(Str("  Registering imports: "))])]),Seq(AM(BA(Call(SVar("get-config"),[]),Str("import")),Var("reps")),Seq(Call(SVar("if-verbose5"),[Call(SVar("debug"),[Build(Str("importing: "))])]),BA(Call(SVar("table-union"),[]),Op("",[Var("XTC"),Var("Import"),Var("reps")])))))))])])
