#! /bin/sh

WORKINGDIR=`pwd`
echo "** INFO -- Working directory: $WORKINGDIR"

# touch bootstrapped sources because subversion doesn't sets the mtime of files
# to checkout time, not to the last mtime in the repository.

MTIME=`date +%Y%m%d%H%M.%S`
echo "** INFO - Modification time: $MTIME"
find . -print | xargs touch -t $MTIME

# end of touch
# install bootstrap time packages: autoxt

mkdir -p pre-pkgs
mkdir -p pre-pkgs/bootstrap
cp -rf autoxt pre-pkgs/bootstrap/
cd pre-pkgs/bootstrap/autoxt
./bootstrap
./configure --prefix=$WORKINGDIR/pre-pkgs/bootstrap
make
make install

cd $WORKINGDIR
export PATH=$WORKINGDIR/pre-pkgs/bootstrap/bin:$PATH

echo "** INFO -- AutoXT is: `which autoxt`"

# end of autoxt install
# proceed with applying the autotools

rm -f mkinstalldirs missing install-sh

PKGS="autoxt srts xtc sdf-import sc ssl gpp c-tools stratego-front aterm-tools asfix-tools dot-tools graph-tools sdf-front sdf-tools stratego-tools boxenv stratego-util"

for dir in $PKGS
do 
  echo
  echo "bootstrapping in $dir"
  echo
  (cd $dir; ./bootstrap)
done

touch README
touch NEWS

rm -f config.cache
rm -f acconfig.h
aclocal -I .
autoconf
autoheader
automake -a

#
# autobundle -- Make distributions by bundling separate software packages.
#
# Copyright (C) 2000 Merijn de Jonge <mdejonge@cwi.nl>
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
# 02111-1307, USA.