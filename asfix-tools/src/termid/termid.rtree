Specification([Imports(["options"]),Signature([Constructors([OpDecl("Strict",ConstType(Var("Option")))])]),Strategies([SDef("io-idwrap",[DefaultVarDec("id"),DefaultVarDec("strat")],Call(SVar("io-idwrap"),[Call(SVar("id"),[]),Call(SVar(""),[Id,Call(SVar("strat"),[])]),Fail])),SDef("io-idwrap",[DefaultVarDec("id"),DefaultVarDec("strat"),DefaultVarDec("extra-options")],Call(SVar("iowrap"),[Seq(Call(SVar("try"),[Call(SVar("termid-check'"),[Call(SVar("id"),[])])]),Seq(Call(SVar("strat"),[]),Call(SVar("try"),[Call(SVar("termid-set'"),[Call(SVar("id"),[])])]))),Choice(Call(SVar("extra-options"),[]),Call(SVar("Option"),[Match(Str("--strict")),Build(Op("Strict",[])),Build(Str("--strict         Use strict typing of input term"))]))])),RDef("InId",[DefaultVarDec("in-type")],Rule(Op("",[Str("in-type"),Explode(Var("i"),Op("Cons",[Var("trm"),Op("Nil",[])]))]),Var("trm"),BA(LChoice(Call(SVar("in-type"),[]),Call(SVar("type-failure"),[])),Var("i")))),RDef("OutId",[DefaultVarDec("out-type")],Rule(Op("",[Str("out-type"),Var("t")]),Var("trm"),AM(BA(Call(SVar("mkterm"),[]),Op("",[App(Call(SVar("out-type"),[]),Op("",[])),Op("Cons",[Var("t"),Op("Nil",[])])])),Var("trm")))),SDef("InOutId",[DefaultVarDec("in-type"),DefaultVarDec("out-type")],Seq(Call(SVar(""),[Match(Str("in-type")),Id]),Call(SVar("InId"),[Call(SVar("in-type"),[])]))),SDef("InOutId",[DefaultVarDec("in-type"),DefaultVarDec("out-type")],Seq(Call(SVar(""),[Match(Str("out-type")),Id]),Call(SVar("OutId"),[Call(SVar("out-type"),[])]))),RDef("termid-check'",[DefaultVarDec("id")],Rule(Op("",[Var("options"),Var("t")]),Op("",[Var("options"),Var("trm")]),AM(BA(Call(SVar("id"),[]),Op("",[Str("in-type"),Var("t")])),Var("trm")))),RDef("termid-check",[DefaultVarDec("id")],Rule(Var("t"),Var("trm"),AM(BA(Call(SVar("InId"),[Call(SVar("id"),[])]),Op("",[Str("in-type"),Var("t")])),Var("trm")))),RDef("termid-set'",[DefaultVarDec("id")],Rule(Op("",[Var("options"),Var("t")]),Op("",[Var("options"),Var("trm")]),AM(BA(Call(SVar("id"),[]),Op("",[Str("out-type"),Var("t")])),Var("trm")))),RDef("termid-set",[DefaultVarDec("id")],Rule(Var("t"),Var("trm"),AM(BA(Call(SVar("OutId"),[Call(SVar("id"),[])]),Op("",[Str("out-type"),Var("t")])),Var("trm")))),SDef("type-failure",[],LChoice(Seq(Call(SVar("has-option"),[Build(Var("Strict"))]),BA(Call(SVar("fatal-error"),[]),Op("Cons",[Str("Fatal: input term has incorrect grammar identifier."),Op("Nil",[])]))),BA(Call(SVar("error"),[]),Op("Cons",[Str("Warning: input term has incorrect grammar identifier."),Op("Nil",[])]))))])])
